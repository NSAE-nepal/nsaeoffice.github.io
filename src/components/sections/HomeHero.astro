---
import { Image } from "astro:assets";
import Badge from "../astro/Badge.astro";
import Button from "../astro/Button/Button.astro";
import ArrowDown from "@tabler/icons/outline/arrow-down.svg";
import homeimage from "../../assets/nsae-logo.png";
---

<section
  class="home-hero-section rounded-2xl relative flex min-h-[85vh] items-center overflow-hidden px-6 py-20 md:px-12 md:py-32"
>
  <div
    class="home-hero-redg-text absolute top-32 left-6 md:left-12 z-20 hidden md:block opacity-0 -translate-y-4"
  >
    <span
      class="font-mono text-xs text-white/60 tracking-widest uppercase vertical-lr"
    >
      [ Regd.No.29/046/047 ]
    </span>
  </div>

  <div
    class="home-hero-text relative z-20 flex max-w-5xl flex-col gap-8 md:gap-10 mt-12"
  >
    <h2
      class="font-sans text-[3.5rem] font-medium leading-[0.9] text-white md:text-[7rem] tracking-tighter"
    >
      <div class="relative inline-block">
        <div class="overflow-hidden inline-block align-bottom pb-4">
          <span
            class="engineering-text-anim inline-block font-bold italic underline decoration-2 underline-offset-12 decoration-white/30 invisible"
          >
            Engineering
          </span>
        </div>
        <Badge
          class="badge-anim-wrapper opacity-0 absolute -top-8 -right-12 rotate-12 font-mono text-xs tracking-wide border-white/40"
          size="sm"
        >
          EST. 1990
        </Badge>
      </div>

      <br />
      <span class="subtitle-lines inline-block text-white/80 invisible"
        >Tomorrow’s Food &</span
      >
      <br />
      <span class="subtitle-lines inline-block text-white/80 invisible"
        >Environmental Systems</span
      >
    </h2>

    <p
      class="hero-desc-anim max-w-xl text-lg text-white/70 font-sans leading-relaxed opacity-0 translate-y-4"
    >
      NSAE connects leading engineers, scientists, and students dedicated to
      creating practical solutions for real‑world agricultural challenges.
    </p>

    <div
      class="hero-actions-anim mt-4 flex items-center gap-6 dark opacity-0 translate-y-4"
    >
      <Button
        href={"/contact"}
        class="rounded-full px-8 py-4 font-sans font-medium"
      >
        Get in Touch
      </Button>

      <a
        href="#mission-brief"
        class="font-mono text-xs text-white/60 uppercase tracking-widest hover:text-white transition-colors flex items-center gap-2"
      >
        ( Explore ) <ArrowDown class="w-3 h-3" />
      </a>
    </div>
  </div>
  <div
    class="scroll-indicator absolute bottom-10 right-12 z-20 hidden md:flex items-center gap-4 opacity-0"
  >
    <span class="font-mono text-xs text-white/50 uppercase"
      >Scroll to explore</span
    >
    <div class="scroll-line h-[1px] w-0 bg-white/30"></div>
  </div>
  <div class="absolute inset-0 z-10">
    <div
      class="absolute rounded-2xl inset-0 z-20 bg-linear-to-r from-black/80 via-black/50 to-transparent"
    >
    </div>

    <div
      class="hero-image-wrapper absolute inset-0 z-10 bg-black/40 rounded-2xl"
    >
    </div>

    <Image
      class="hero-image-anim absolute inset-0 h-full w-full object-cover rounded-2xl scale-110"
      alt="Agricultural Engineering"
      inferSize
      src={homeimage}
    />
  </div>
</section>

<script>
  import { gsap, SplitText } from "@/utils/gsap-init";

  if (typeof window !== "undefined") {
    const section = document.querySelectorAll(".home-hero-section");
    gsap.set(section, { autoAlpha: 1 });

    const subtitleInner = SplitText.create(".subtitle-lines", {
      type: "lines",
      linesClass: "line-inner will-change-transform",
    });

    const tl = gsap.timeline({
      defaults: { ease: "power3.out" },
      scrollTrigger: {
        trigger: ".home-hero-section",
        start: "top 75%",
        end: "top 20%",
        toggleActions: "play none none reverse",
      },
    });

    tl.to(
      ".hero-image-anim",
      {
        scale: 1,
        duration: 2.5,
        ease: "expo.out",
      },
      0,
    );

    tl.to(
      ".home-hero-redg-text",
      {
        y: 0,
        opacity: 1,
        duration: 1.5,
        ease: "power3.out",
      },
      0.2,
    );

    tl.set(".engineering-text-anim", { autoAlpha: 1 }, 0.3);
    tl.from(
      ".engineering-text-anim",
      {
        yPercent: 100,
        rotation: 2,
        opacity: 0,
        duration: 1.2,
        ease: "power4.out",
      },
      0.3,
    );

    tl.to(
      ".badge-anim-wrapper",
      {
        opacity: 1,
        scale: 1,
        rotation: 12,
        startAt: { scale: 0, rotation: 0 },
        duration: 0.8,
        ease: "back.out(1.7)",
      },
      0.8,
    );

    tl.set(".subtitle-lines", { autoAlpha: 1 }, 0.5);
    tl.from(
      subtitleInner.lines,
      {
        yPercent: 100,
        opacity: 0,
        duration: 1.1,
        stagger: 0.1,
        ease: "power4.out",
      },
      0.5,
    );

    tl.to(
      [".hero-desc-anim", ".hero-actions-anim"],
      {
        y: 0,
        opacity: 1,
        stagger: 0.1,
        duration: 0.5,
      },
      "-=1",
    );
    tl.to(".scroll-indicator", { opacity: 1, duration: 1 }, "-=1");
    tl.to(
      ".scroll-line",
      { width: 48, duration: 1, ease: "expo.out" },
      "-=0.5",
    );

    gsap.to(".hero-image-anim", {
      yPercent: 20,
      ease: "none",
      scrollTrigger: {
        trigger: ".home-hero-section",
        start: "top top",
        end: "bottom top",
        scrub: true,
      },
    });
  }
</script>
